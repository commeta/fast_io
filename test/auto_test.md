# Авто тест базы данных


Файл скрипта auto_test.php

Страница описания прокта [Fast_IO Engine](https://github.com/commeta/fast_io).


### Процедура тестирования

Тест для функции file_insert_line начинается с создания файла базы данных fast_io.dat. Затем генерируется случайный размер выравнивания и устанавливается размер буфера. После этого выполняется цикл, в котором в файл базы данных вставляются строки с использованием функции file_insert_line. Каждая вставленная строка проверяется на соответствие ожидаемым параметрам, включая размер и содержание. Также проверяется, что позиции вставленных строк корректны.

Плюсы этого теста включают:
- Использование случайных значений для имитации различных сценариев использования в допустимых диапазонах.
- Проверка различных аспектов работы функций, включая размер строк, содержание и позицию в файле.
- Проверка сходимости базы данных, убеждаясь, что вставленные строки находятся в правильном месте и имеют правильные размеры.
- Тест выводит на экран все ошибки и предупреждения, которые могут возникнуть при работе с базой данных.
- Тест выявляет нестабильное поведение, если генерация случайных значений приведет к ошибкам в работе расширения.

Минусы этого теста включают:
- Тест может быть медленным из-за большого количества операций: вызов функций в цикле, чтение и запись.


#### Тестирование функций
- file_insert_line - Тест сходимости с участием: file_get_keys, file_analize, +рандомный размер буфера.
- file_analize - Тест сходимости 1 режима, с участием: file_insert_line, +рандомный размер буфера.
- file_get_keys - Тест сходимости транзакционных режимов, с участием: file_insert_line, +рандомный размер буфера.
- file_search_array - Тест сходимости транзакционных режимов, с участием: file_insert_line, +рандомный размер буфера.
- file_select_array - Тест сходимости транзакционных режимов, с участием: file_insert_line, +рандомный размер буфера.


#### Результат выполнения
Результат тестирования: Ubuntu 24.04, Ryzen 12 Cores, 16GB RAM, SATA 3 SSD.
```
root@api:/home/commeta/project/kernel/fast_io# php auto_test.php 
Check file_insert_line: time: 2.5048358440399 rchar: 716706563 wchar: 195118509 syscr: 84589 syscw: 10653 write_bytes: 195342336 cancelled_write_bytes: 194842624 - PASS
Check file_analize: time: 4.629292011261 rchar: 6360648535 wchar: 189528394 syscr: 650632 syscw: 10754 write_bytes: 189730816 cancelled_write_bytes: 190377984 - PASS
Check file_get_keys: time: 1.9452168941498 rchar: 867169836 wchar: 144331214 syscr: 94137 syscw: 9756 write_bytes: 144543744 cancelled_write_bytes: 141393920 - PASS
Check file_search_array: time: 3.204206943512 rchar: 2146910724 wchar: 178712592 syscr: 175099 syscw: 11092 write_bytes: 178925568 cancelled_write_bytes: 181268480 - PASS
Check file_select_array: time: 3.433385848999 rchar: 2819114594 wchar: 187746354 syscr: 160203 syscw: 10970 write_bytes: 187961344 cancelled_write_bytes: 186281984 - PASS

```
