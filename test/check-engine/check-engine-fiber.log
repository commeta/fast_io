╔══════════════════════════════════════════════════════════════════╗
║      fast_io ASYNC FIBER СТРЕСС-ТЕСТ  v1.0                       ║
╚══════════════════════════════════════════════════════════════════╝

Fibers (workers)     : 12
Итераций на fiber    : 120
Рабочая директория   : /tmp/fast_io_fiber_46569
PHP                  : 8.3.6


──────────────────────────────────────────────────────────────────────
  ФАЗА: PHASE 0 — Подготовка общего файла и карты консистентности
──────────────────────────────────────────────────────────────────────
Вставлено строк      : 1440 / 1440
Размер файла         : 737,280 байт
min/max/avg строк    : 512 / 512 / 512
flow_interruption    : 0
✅  PHASE 0 подготовка — PASS (0.0285s)
  rchar:                              5.902 MB  (  207.10 MB/s)
  wchar:                              1.475 MB  (   51.74 MB/s)
  syscr:                               2539 ops (   89088 ops/s)
  syscw:                               2880 ops (  101053 ops/s)
  read_bytes:                             0 MB  (    0.00 MB/s)
  write_bytes:                        1.475 MB  (   51.74 MB/s)
  cancelled_write_bytes:                  0 MB  (    0.00 MB/s)

──────────────────────────────────────────────────────────────────────
  ФАЗА: PHASE 1 — Параллельное выполнение (все fiber-воркеры)
──────────────────────────────────────────────────────────────────────

──────────────────────────────────────────────────────────────────────
  ФАЗА: PHASE 2 — Консистентность данных (главный поток читает после всех fibers)
──────────────────────────────────────────────────────────────────────
Проверено ячеек : 1440
Повреждено      : 0
✅  PHASE 2 консистентность — PASS (0.0215s)
  rchar:                             16.929 MB  (  787.39 MB/s)
  wchar:                                  0 MB  (    0.00 MB/s)
  syscr:                               5403 ops (  251302 ops/s)
  syscw:                                  0 ops (       0 ops/s)
  read_bytes:                             0 MB  (    0.00 MB/s)
  write_bytes:                            0 MB  (    0.00 MB/s)
  cancelled_write_bytes:                  0 MB  (    0.00 MB/s)

──────────────────────────────────────────────────────────────────────
  ФАЗА: PHASE 3 — Финальный анализ файлов
──────────────────────────────────────────────────────────────────────
  line_count:               1440
  file_size:                737,280 B
  min_length:               512
  max_length:               512
  avg_length:               512.0
  flow_interruption:        0
  last_symbol (10=LF):      10
✅  PHASE 3 анализ — PASS (0.0005s)
  rchar:                              0.741 MB  ( 1482.99 MB/s)
  wchar:                                  0 MB  (    0.46 MB/s)
  syscr:                                 13 ops (   26000 ops/s)
  syscw:                                  7 ops (   14000 ops/s)
  read_bytes:                             0 MB  (    0.00 MB/s)
  write_bytes:                            0 MB  (    0.00 MB/s)
  cancelled_write_bytes:                  0 MB  (    0.00 MB/s)

──────────────────────────────────────────────────────────────────────
  ФАЗА: PHASE 4 — Сводная статистика по fiber-воркерам
──────────────────────────────────────────────────────────────────────

  SUB-TEST                W0   W1   W2   W3   W4   W5   W6   W7   W8   W9   W10  W11  PASS/TOTAL
  ──────────────────────────────────────────────────────────────────────────────────────────────
  select_line             ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  12/12
  select_array            ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  12/12
  update_line             ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  12/12
  update_array            ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  12/12
  search_line             ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  12/12
  search_array            ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  12/12
  get_keys                ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  12/12
  erase_line              ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  12/12
  push_search_data        ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  12/12
  callback_line           ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  12/12
  file_analize            ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  12/12
  find_matches_pcre2      ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  12/12
  replace_line            ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  12/12
  pop_line                ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  12/12
  replicate_file          ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  12/12
  defrag_data             ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  ✅  12/12

  ОШИБКИ ПО ВОРКЕРАМ:
  Ошибок не обнаружено ✅

──────────────────────────────────────────────────────────────────────
  ФАЗА: PHASE 5 — Суммарная статистика ввода/вывода (один процесс)
──────────────────────────────────────────────────────────────────────
  Общее время выполнения: 0.115 сек

  СТАТИСТИКА ЯДРА LINUX (/proc/PID/io):
  rchar:                             66.397 MB  (  577.36 MB/s)
  wchar:                              2.249 MB  (   19.56 MB/s)
  syscr:                              16616 ops (  144487 ops/s)
  syscw:                               5470 ops (   47565 ops/s)
  read_bytes:                             0 MB  (    0.00 MB/s)
  write_bytes:                        2.302 MB  (   20.02 MB/s)
  cancelled_write_bytes:              0.786 MB  (    6.84 MB/s)

  АГРЕГИРОВАННЫЙ IO ПО SUB-ТЕСТАМ (по всем воркерам):
  select_line:           rchar=   2.08 MB  wchar=   0.00 MB  syscr=   708  syscw=     0  avg_t= 0.00023s
  select_array:          rchar=   0.15 MB  wchar=   0.00 MB  syscr=    72  syscw=     0  avg_t= 0.00003s
  update_line:           rchar=   2.26 MB  wchar=   0.15 MB  syscr=   840  syscw=   300  avg_t= 0.00041s
  update_array:          rchar=   1.06 MB  wchar=   0.06 MB  syscr=   348  syscw=   120  avg_t= 0.00012s
  search_line:           rchar=   4.39 MB  wchar=   0.00 MB  syscr=   270  syscw=     0  avg_t= 0.00010s
  search_array:          rchar=   8.86 MB  wchar=   0.00 MB  syscr=   508  syscw=     0  avg_t= 0.00020s
  get_keys:              rchar=   0.49 MB  wchar=   0.00 MB  syscr=    60  syscw=     0  avg_t= 0.00002s
  erase_line:            rchar=   3.49 MB  wchar=   0.25 MB  syscr=   864  syscw=   480  avg_t= 0.00048s
  push_search_data:      rchar=   2.35 MB  wchar=   0.03 MB  syscr=  1353  syscw=   488  avg_t= 0.00064s
  callback_line:         rchar=   4.32 MB  wchar=   0.00 MB  syscr=   266  syscw=     0  avg_t= 0.00020s
  file_analize:          rchar=   8.90 MB  wchar=   0.00 MB  syscr=   552  syscw=     0  avg_t= 0.00044s
  find_matches_pcre2:    rchar=   0.00 MB  wchar=   0.00 MB  syscr=    36  syscw=     0  avg_t= 0.00001s
  replace_line:          rchar=   0.02 MB  wchar=   0.01 MB  syscr=   204  syscw=   144  avg_t= 0.00019s
  pop_line:              rchar=   3.94 MB  wchar=   0.18 MB  syscr=  1188  syscw=   360  avg_t= 0.00089s
  replicate_file:        rchar=   0.40 MB  wchar=   0.06 MB  syscr=   228  syscw=    72  avg_t= 0.00021s
  defrag_data:           rchar=   0.09 MB  wchar=   0.02 MB  syscr=   576  syscw=   348  avg_t= 0.00047s

──────────────────────────────────────────────────────────────────────
  ФАЗА: PHASE 6 — Пропускная способность (throughput)
──────────────────────────────────────────────────────────────────────
  Чтение символов (rchar):    577.362 MB/s  (всего     66.397 MB)
  Запись символов (wchar):     19.560 MB/s  (всего      2.249 MB)
  Физ.чтение (read_bytes):        0.000 MB/s  (всего      0.000 MB)
  Физ.запись (write_bytes):      20.017 MB/s  (всего      2.302 MB)
  Системных вызовов чтения (syscr):     144487  ops/s  (всего        16616)
  Системных вызовов записи (syscw):      47565  ops/s  (всего         5470)

══════════════════════════════════════════════════════════════════════
  ИТОГ
══════════════════════════════════════════════════════════════════════
  Время выполнения          : 0.115 сек
  Fibers (всего/упало)      : 12 / 0
  Строк в файле             : 1440
  flow_interruption         : 0
  Проверено ячеек (consist.): 1440
  Повреждено ячеек          : 0
  Ошибок в воркерах         : 0

✅  check-engine-fiber.php — УСПЕШНО ПРОЙДЕН
    Библиотека fast_io корректно работает в fiber-среде.
    Данные консистентны. Блокировки работают верно.

  Файлы теста: /tmp/fast_io_fiber_46569 (будут удалены)
  Очистка завершена.
