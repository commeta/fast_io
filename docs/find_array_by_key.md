# Описание функции find_array_by_key

Функция find_array_by_key осуществляет поиск значения по ключу в файле данных. 
Она выполняет посекторный низкоуровневый поиск и возвращает найденное значение. 
Файл читается порциями, что делает функцию эффективной для работы с большими файлами. 

Функция написана на C и доступна в PHP через специализированное расширение Fast_IO.

## Синтаксис

mixed find_array_by_key(string $filename, string $index_key[, int search_state = 0][, int search_start = 0][, int search_length = 1] )


### Параметры

- **filename** - Путь к файлу, в котором будет производиться поиск.
- **index_key** - Ключ, по которому осуществляется поиск значения.
- **search_state** (int, optional) - Режим поиска.
- **search_start** (int, optional) - Стартовая строка начала выборки.
- **search_length** (int, optional) - Длина массива выборки.


#### Режимы поиска


- 0: Поиск index_key в каждой строке, полнотекстовый поиск, возвращает массив найденных строк.
- 1: Поиск index_key в каждой строке, полнотекстовый поиск, возвращает номера найденных строк.
- 2: Поиск index_key в каждой строке, полнотекстовый поиск, возвращает смещение найденных строк.
- 3: Поиск index_key в каждой строке, полнотекстовый поиск, возвращает общее количество найденных строк в файле.

- 10: Поиск по регулярному выражению PCRE2 в каждой строке, полнотекстовый поиск, возвращает массив найденных строк.
- 11: Поиск по регулярному выражению PCRE2 в каждой строке, возвращает номера найденных строк.
- 12: Поиск по регулярному выражению PCRE2 в каждой строке, возвращает смещение найденных строк.
- 13: Поиск по регулярному выражению PCRE2 в каждой строке, возвращает общее количество найденных строк в файле.


### Возвращаемые значения

Функция возвращает массив строк, содержащий значения, ассоциированное с найденной строкой.
Вслучае, если ключ не найден или произошла ошибка (например, файл не может быть прочитан), функция возвращает пустой массив или NULL.
Строки возвращается без конечных пробелов и символа перевода строки.

## Пример использования

В этом примере мы ищем значение по ключу "user_id" в файле "data.txt".
```
<?php
$filename = 'path/to/data.txt';
$key = 'user_id';

$value = find_array_by_key($filename, $key);

if ($value !== NULL) {
    print_r(["Найденное значение: ", $value]);
} else {
    echo "Значение не найдено или произошла ошибка";
}
?>
```

Еще [пример](/test/test.php): стресс тест.

### Формат файла

Функция предполагает, что файл содержит данные в формате "ключ значение", где каждая пара разделена новой строкой. Например:

```
index_0 data_write_key_value_pair_0
index_1 data_write_key_value_pair_1
index_2 data_write_key_value_pair_2
```


## Ограничения

- Файл должен быть доступен для чтения процессом PHP.
- Функция читает файл порциями, размер которых определяется константой BUFFER_SIZE.

## Стоимость вызова

- CPU Bound - Заполнение буфера и полнотекстовый поиск в каждой строке, регулярные выражения PCRE2.
- IO Bound - Посекторное чтение файла в буфер.

Среднее потребление, чтение всего файла в режимах.
