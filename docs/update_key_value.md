# Описание функции update_key_value

Функция update_key_value предназначена для обновления значения по ключу в текстовом файле. Эта функция является частью PHP расширения Fast_IO, написанного на C, 
и предоставляет возможность эффективно обновлять строки в больших файлах без необходимости загружать весь файл в память.

## Прототип функции

bool update_key_value(string $filename, string $index_key, int $index_row, int $index_align)


## Параметры

- filename - строка, путь к файлу, в котором будет производиться обновление.
- index_key - строка, значение ключа, которое будет записано в файл.
- index_row - целое число, номер строки (записи), которую необходимо обновить. Нумерация начинается с 1.
- index_align - целое число, размер одной записи в файле (включая возможный разделитель записей).

## Возвращаемые значения

- Возвращает количество записанных байт.
- Возвращает -1, если не удалось открыть файл.
- Возвращает -2, если не удалось заблокировать файл.
- Возвращает -3, если не удалось установить указатель файла в нужную позицию.
- Возвращает -4, если не удалось записать данные в файл.

## Пример использования

В следующем примере показано, как использовать функцию update_key_value для обновления строки в файле:
```
<?php

$result = update_key_value("path/to/your/file.txt", "newValue", 3, 20);

if ($result < 0) {
    echo "Ошибка при обновлении записи: код ошибки $result.";
} else {
    echo "Запись успешно обновлена.";
}

?>
```
В этом примере функция update_key_value используется для обновления значения в третьей записи файла file.txt. Размер каждой записи установлен в 20 байт.


Еще [пример](/test/readme.md): Тесты.

## Примечания

- Функция блокирует файл на время операции, предотвращая одновременный доступ других процессов.
- Перед использованием убедитесь, что файл существует и имеет правильный формат записей.

## Стоимость вызова

- CPU Bound - Подготовка строки к записи с учетом выравнивания и перевода строки
- IO Bound - Посекторная запись в файл по указанному смещению и размеру.

Очень низкое потребление, посекторная запись отрезка файла.

---

Обратите внимание, что для работы с этой функцией требуется предварительно скомпилированное и установленное PHP расширение Fast_IO, содержащее определение функции update_key_value.
