# Описание функции file_select_line

Функция file_select_line предназначена для выборки строки по указанному номеру строки и выравниванию из текстового файла. Эта функция может быть особенно полезна при работе с файлами, структурированными в виде таблиц, где каждая запись имеет фиксированную длину. Функция реализована на языке C и доступна в PHP через специальное расширение.


Страница описания прокта [Fast_IO Engine](https://github.com/commeta/fast_io).


## Синтаксис

string file_select_line(string $filename, int $row, int $align[, int mode = 0] )


### Параметры

- **filename** - Путь к файлу, в котором будет производиться поиск.
- **row** - Номер строки (либо смещение в файле), которую необходимо прочитать. Нумерация начинается с 0.
- **align** - Размер выравнивания строки в файле (длина строки в символах).
- **mode** (int, optional) - Режим выборки.


#### Режимы поиска
- 0, 2: Выборка строки по номеру с учетом выравнивания, режим 2 возвращает сырую строку.
- 1, 3: Выборка строки по смещению без выравнивания, режим 3 возвращает сырую строку.
- +100 Log mode: Если добавить +100 к любому из вышеперечисленных режимов, функция пересчитает режим mode -= 100 но не будет блокировать файл.

Режимы +100 Log mode подходят для работы с файлами журналов.

## Возвращаемые значения

В случае успешного выполнения функция возвращает строку, прочитанную из файла. Если в процессе выполнения возникли ошибки (например, файл не удалось открыть или заблокировать для чтения), функция возвращает FALSE.

В режиме mode=1 можно указать любой размер строки align, строка будет обрезана по символу перевода строки. Если символ перевода строки не будет найден, функция вернет подстроку.

В режимах mode=0 и mode=1 строка возвращается без конечных пробелов и символа перевода строки.


## Пример использования
```
<?php
$filename = "/path/to/your/file.txt";
$row = 2; // Номер строки, которую хотим прочитать
$line_align = 100; // Длина каждой строки в файле

$value = file_select_line($filename, $row, $line_align);

if ($value !== FALSE) {
    echo "Прочитанная строка: $value";
} else {
    echo "Произошла ошибка при чтении файла.";
}
?>
```

В этом примере мы пытаемся прочитать строку под номером 2 из файла file.txt, где каждая запись имеет длину 100 символов. Если операция проходит успешно, выводится прочитанная строка. В случае ошибки выводится сообщение о возникшей проблеме.

Еще [пример](/test/readme.md): Тесты.

## Примечания

- Файл автоматически блокируется на время чтения для предотвращения одновременного доступа.
- Для работы функции необходимо, чтобы файл существовал и был доступен для чтения.
- Строка возвращается без конечных пробелов, что удобно при работе с текстовыми данными.

Эта функция является частью специализированного расширения PHP и требует его предварительной установки и активации.


## Стоимость вызова

- CPU Bound - Обрезка пробелов справа и символа перевода строки.
- IO Bound - Посекторное чтение файла по указанному смещению и размеру.

Очень низкое потребление, посекторное чтение отрезка файла.
