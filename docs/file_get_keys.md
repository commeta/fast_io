# Описание функции file_get_keys

Функция file_get_keys предназначена для извлечения ключей или данных о косвенной адресации текстового файла, где каждая строка содержит пары ключ-значение, разделенные пробелом.

Эта функция реализована на языке C и доступна в PHP через Fast_IO специальное расширение.

Функция file_get_keys проходит по всему файлу, читая его содержимое и извлекая ключи из каждой строки. Ключи собираются в массив. Результатом работы функции является массив уникальных ключей.


## Синтаксис

array file_get_keys(string $filename[, int mode = 0][, int search_start = 0][, int search_length = 1] )


### Параметры

- **filename** (string): Путь к файлу, из которого необходимо извлечь ключи.
- **mode** (int, optional) - Режим поиска.
- **search_start** (int, optional) - Стартовая строка начала выборки.
- **search_limit** (int, optional) - Ограничение массива выборки.

### Возвращаемое значение

- В режиме 0 - функция возвращает массив строк (array), каждый элемент которого является уникальным ключом, извлеченным из файла.
- В режиме 1 - функция возвращает массив (array), каждый элемент которого содержит элементы: [0] смещение и [1] размер строки в файле.
- В режиме 2 - тоже что и 0 только search_start содержит смещение offset начала поиска выборки в файле. 
- В режиме 3 - тоже что и 1 только search_start содержит смещение offset начала поиска выборки в файле. 

Режимы 2 и 3 могут потребоваться для пагинации таблицы ключей или пагинации таблицы распределения косвенной адресации строк в файле.

В этих режимах позиция начала чтения в файле устанавливается на search_start теперь это offset в файле.

### Примеры возвращаемых массивов

```
for($i=0; $i <=500; $i++){
	print_r(
		file_insert_line(__DIR__ . '/fast_io1.dat', 'index_' . $i . ' insert_key_value_' . $i . ' ' . str_pad('', 8, '1234567890'), 8192)
	);
}

print_r([
	file_get_keys(__DIR__ . '/fast_io1.dat', 0, 0, 3),
	file_get_keys(__DIR__ . '/fast_io1.dat', 1, 0, 3),
]);

0, 1, 2, 3, 4, Array
(
    [0] => Array
        (
            [0] => index_0
            [1] => index_1
            [2] => index_2
        )

    [1] => Array
        (
            [0] => Array
                (
                    [0] => 0
                    [1] => 8192
                )

            [1] => Array
                (
                    [0] => 8192
                    [1] => 8192
                )

            [2] => Array
                (
                    [0] => 16384
                    [1] => 8192
                )

        )

)
```




Еще [пример](/test/readme.md): Тесты.

## Замечания

- Файл должен быть доступен для чтения процессом, выполняющим PHP-скрипт.
- В случае ошибки при открытии файла или его блокировке, функция вернет пустой массив.
- Функция не чувствительна к регистру ключей и возвращает их в том виде, в каком они представлены в файле.


## Стоимость вызова

- CPU Bound - Заполнение буфера и полнотекстовый поиск в начале каждой строки.
- IO Bound - Посекторное чтение файла в буфер.

Среднее потребление, чтение всего файла.
